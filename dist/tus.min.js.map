{"version":3,"sources":["node_modules/browserify/node_modules/browser-pack/_prelude.js","lib\\browser\\fingerprint.js","lib\\browser\\isCordova.js","lib\\browser\\isReactNative.js","lib\\browser\\readAsByteArray.js","lib\\browser\\request.js","lib\\browser\\source.js","lib\\browser\\storage.js","lib\\browser\\uriToBlob.js","lib\\error.js","lib\\index.js","lib\\upload.js","node_modules/extend/index.js","node_modules/js-base64/base64.js","node_modules/querystringify/index.js","node_modules/requires-port/index.js","node_modules/url-parse/index.js"],"names":["f","exports","module","define","amd","g","window","global","self","this","tus","e","t","n","r","s","o","u","a","require","i","Error","code","l","call","length","1","_dereq_","fingerprint","_isReactNative","_isCordova","file","options","callback","_isCordova2","default","_isReactNative2","reactNativeFingerprint","name","type","size","lastModified","endpoint","join","exifHash","exif","hashCode","JSON","stringify","str","hash","char","charCodeAt","isCordova","PhoneGap","Cordova","cordova","isReactNative","navigator","product","toLowerCase","readAsByteArray","chunk","reader","FileReader","onload","Uint8Array","result","onerror","err","readAsArrayBuffer","newRequest","resolveUrl","_urlParse","XMLHttpRequest","origin","link","_urlParse2","toString","getSource","_uriToBlob","_readAsByteArray","FileSource","_classCallCheck","_file","start","end","_readAsByteArray2","slice","StreamSource","chunkSize","_chunkSize","_buffer","undefined","_bufferOffset","_reader","_done","_readUntilEnoughDataOrDone","_this","hasEnoughData","len","value","_getDataFromBuffer","read","then","_ref","done","concat","catch","hasAllDataBeenRead","cancel","blobOrArray","b","Blob","set","c","constructor","input","__tus__forceReactNative","uri","_uriToBlob2","blob","isFinite","getStorage","hasStorage","key","localStorage","setItem","getItem","SECURITY_ERR","QUOTA_EXCEEDED_ERR","canStoreURLs","LocalStorage","cb","removeItem","uriToBlob","xhr","responseType","response","open","send","DetailedError","error","causingErr","arguments","_possibleConstructorReturn","__proto__","Object","getPrototypeOf","message","originalRequest","causingError","status","responseText","_upload","_storage","storage","defaultOptions","_upload2","moduleExport","Upload","_window","isSupported","prototype","FileStorage","_error","_extend","_jsBase","_request","_source","_fingerprint","_fingerprint2","resume","onProgress","onChunkComplete","onSuccess","onError","headers","Infinity","withCredentials","uploadUrl","uploadSize","overridePatchMethod","retryDelays","removeFingerprintOnSuccess","uploadLengthDeferred","urlStorage","fileReader","_extend2","url","_xhr","_offset","_aborted","_size","_retryAttempt","_retryTimeout","_offsetBeforeRetry","_emitError","_start","source","_this2","isNaN","errorCallback","shouldResetDelays","isOnline","onLine","isServerError","inStatusCategory","shouldRetry","delay","setTimeout","_resumeUpload","_hasStorage","fingerprintValue","resumedUrl","_createUpload","abort","close","clearTimeout","_error2","bytesSent","bytesTotal","bytesAccepted","setRequestHeader","_this3","_emitXhrError","location","getResponseHeader","_emitSuccess","_startUpload","_setupXHR","metadata","encodeMetadata","_this4","offset","parseInt","_emitProgress","_this5","_emitChunkComplete","upload","onprogress","lengthComputable","loaded","complete","encoded","push","Base64","encode","category","hasOwn","hasOwnProperty","toStr","defineProperty","gOPD","getOwnPropertyDescriptor","isArray","arr","Array","isPlainObject","obj","hasOwnConstructor","hasIsPrototypeOf","setProperty","target","enumerable","configurable","newValue","writable","getProperty","extend","src","copy","copyIsArray","clone","deep","factory","_Base64","version","buffer","eval","b64chars","b64tab","bin","charAt","fromCharCode","String","cb_utob","cc","re_utob","utob","replace","cb_encode","ccc","padlen","ord","chars","btoa","_encode","from","urisafe","m0","encodeURI","re_btou","RegExp","cb_btou","cccc","cp","btou","cb_decode","atob","_decode","decode","noConflict","VERSION","fromBase64","toBase64","__buffer__","noEnum","v","extendString","has","decodeURIComponent","querystring","query","parser","part","exec","querystringify","prefix","pairs","encodeURIComponent","parse","required","port","protocol","split","qs","protocolre","slashes","rules","sanitize","address","NaN","ignore","lolcation","loc","finaldestination","Url","unescape","pathname","test","href","extractProtocol","match","rest","resolve","relative","base","path","last","unshift","up","splice","extracted","instruction","index","instructions","indexOf","host","hostname","username","password","auth","fn","pop","ins"],"mappings":"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ACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;ACrHA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;;ACvOA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AC3EA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;ACtCA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"generated.js","sourceRoot":"","sourcesContent":["(function e(t,n,r){function s(o,u){if(!n[o]){if(!t[o]){var a=typeof require==\"function\"&&require;if(!u&&a)return a(o,!0);if(i)return i(o,!0);var f=new Error(\"Cannot find module '\"+o+\"'\");throw f.code=\"MODULE_NOT_FOUND\",f}var l=n[o]={exports:{}};t[o][0].call(l.exports,function(e){var n=t[o][1][e];return s(n?n:e)},l,l.exports,e,t,n,r)}return n[o].exports}var i=typeof require==\"function\"&&require;for(var o=0;o<r.length;o++)s(r[o]);return s})","import isReactNative from \"./isReactNative\";\r\nimport isCordova from \"./isCordova\";\r\n\r\n/**\r\n * Generate a fingerprint for a file which will be used the store the endpoint\r\n *\r\n * @param {File} file\r\n * @param {Object} options\r\n * @param {Function} callback\r\n */\r\nexport default function fingerprint(file, options, callback) {\r\n  if (isCordova()) {\r\n    return callback(new Error(\"Fingerprint cannot be computed for file input type\"));\r\n  }\r\n\r\n  if (isReactNative) {\r\n    return callback(null, reactNativeFingerprint(file, options));\r\n  }\r\n\r\n  return callback(null, [\r\n    \"tus-br\",\r\n    file.name,\r\n    file.type,\r\n    file.size,\r\n    file.lastModified,\r\n    options.endpoint\r\n  ].join(\"-\"));\r\n}\r\n\r\nfunction reactNativeFingerprint(file, options) {\r\n  let exifHash = file.exif ? hashCode(JSON.stringify(file.exif)) : \"noexif\";\r\n  return [\r\n    \"tus-rn\",\r\n    file.name || \"noname\",\r\n    file.size || \"nosize\",\r\n    exifHash,\r\n    options.endpoint\r\n  ].join(\"/\");\r\n}\r\n\r\nfunction hashCode(str) {\r\n  // from https://stackoverflow.com/a/8831937/151666\r\n  var hash = 0;\r\n  if (str.length === 0) {\r\n    return hash;\r\n  }\r\n  for (var i = 0; i < str.length; i++) {\r\n    var char = str.charCodeAt(i);\r\n    hash = ((hash << 5) - hash) + char;\r\n    hash = hash & hash; // Convert to 32bit integer\r\n  }\r\n  return hash;\r\n}\r\n","const isCordova = () => typeof window != \"undefined\" && (\r\n  typeof window.PhoneGap != \"undefined\" ||\r\n    typeof window.Cordova != \"undefined\" ||\r\n    typeof window.cordova != \"undefined\");\r\n\r\nexport default isCordova;\r\n","const isReactNative = (typeof navigator !== \"undefined\" &&\r\n  typeof navigator.product === \"string\" &&\r\n  navigator.product.toLowerCase() === \"reactnative\");\r\n\r\nexport default isReactNative;\r\n","/**\r\n * readAsByteArray converts a File object to a Uint8Array.\r\n * This function is only used on the Apache Cordova platform.\r\n * See https://cordova.apache.org/docs/en/latest/reference/cordova-plugin-file/index.html#read-a-file\r\n */\r\nfunction readAsByteArray(chunk, callback) {\r\n  let reader = new FileReader();\r\n  reader.onload = () => {\r\n    callback(null, new Uint8Array(reader.result));\r\n  };\r\n  reader.onerror = (err) => {\r\n    callback(err);\r\n  };\r\n  reader.readAsArrayBuffer(chunk);\r\n}\r\n\r\nexport default readAsByteArray;\r\n","/* global window */\r\nimport URL from \"url-parse\";\r\n\r\nexport function newRequest() {\r\n  return new window.XMLHttpRequest();\r\n}\r\n\r\nexport function resolveUrl(origin, link) {\r\n  return new URL(link, origin).toString();\r\n}\r\n","import isReactNative from \"./isReactNative\";\r\nimport uriToBlob from \"./uriToBlob\";\r\nimport isCordova from \"./isCordova\";\r\nimport readAsByteArray from \"./readAsByteArray\";\r\n\r\nclass FileSource {\r\n  constructor(file) {\r\n    this._file = file;\r\n    this.size = file.size;\r\n  }\r\n\r\n  slice(start, end, callback) {\r\n    // In Apache Cordova applications, a File must be resolved using\r\n    // FileReader instances, see\r\n    // https://cordova.apache.org/docs/en/8.x/reference/cordova-plugin-file/index.html#read-a-file\r\n    if (isCordova()) {\r\n      readAsByteArray(this._file.slice(start, end), (err, chunk) => {\r\n        if (err) return callback(err);\r\n\r\n        callback(null, chunk);\r\n      });\r\n      return;\r\n    }\r\n\r\n    callback(null, this._file.slice(start, end));\r\n  }\r\n\r\n  close() {}\r\n}\r\n\r\nclass StreamSource {\r\n  constructor(reader, chunkSize) {\r\n    this._chunkSize = chunkSize;\r\n    this._buffer = undefined;\r\n    this._bufferOffset = 0;\r\n    this._reader = reader;\r\n    this._done = false;\r\n  }\r\n\r\n  slice(start, end, callback) {\r\n    if (start < this._bufferOffset) {\r\n      callback(new Error(\"Requested data is before the reader's current offset\"));\r\n      return;\r\n    }\r\n\r\n    return this._readUntilEnoughDataOrDone(start, end, callback);\r\n  }\r\n\r\n  _readUntilEnoughDataOrDone(start, end, callback) {\r\n    const hasEnoughData = end <= this._bufferOffset + len(this._buffer);\r\n    if (this._done || hasEnoughData) {\r\n      var value = this._getDataFromBuffer(start, end);\r\n      callback(null, value, value == null ? this._done : false);\r\n      return;\r\n    }\r\n    this._reader.read().then(({ value, done }) => {\r\n      if (done) {\r\n        this._done = true;\r\n      } else if (this._buffer === undefined) {\r\n        this._buffer = value;\r\n      } else {\r\n        this._buffer = concat(this._buffer, value);\r\n      }\r\n\r\n      this._readUntilEnoughDataOrDone(start, end, callback);\r\n    }).catch(err => {\r\n      callback(new Error(\"Error during read: \"+err));\r\n    });\r\n  }\r\n\r\n  _getDataFromBuffer(start, end) {\r\n    // Remove data from buffer before `start`.\r\n    // Data might be reread from the buffer if an upload fails, so we can only\r\n    // safely delete data when it comes *before* what is currently being read.\r\n    if (start > this._bufferOffset) {\r\n      this._buffer = this._buffer.slice(start - this._bufferOffset);\r\n      this._bufferOffset = start;\r\n    }\r\n    // If the buffer is empty after removing old data, all data has been read.\r\n    const hasAllDataBeenRead = len(this._buffer) === 0;\r\n    if (this._done && hasAllDataBeenRead) {\r\n      return null;\r\n    }\r\n    // We already removed data before `start`, so we just return the first\r\n    // chunk from the buffer.\r\n    return this._buffer.slice(0, end - start);\r\n  }\r\n\r\n  close() {\r\n    if (this._reader.cancel) {\r\n      this._reader.cancel();\r\n    }\r\n  }\r\n}\r\n\r\nfunction len(blobOrArray) {\r\n  if (blobOrArray === undefined) return 0;\r\n  if (blobOrArray.size !== undefined) return blobOrArray.size;\r\n  return blobOrArray.length;\r\n}\r\n\r\n/*\r\n  Typed arrays and blobs don't have a concat method.\r\n  This function helps StreamSource accumulate data to reach chunkSize.\r\n*/\r\nfunction concat(a, b) {\r\n  if (a.concat) { // Is `a` an Array?\r\n    return a.concat(b);\r\n  }\r\n  if (a instanceof Blob) {\r\n    return new Blob([a,b], {type: a.type});\r\n  }\r\n  if (a.set) { // Is `a` a typed array?\r\n    var c = new a.constructor(a.length + b.length);\r\n    c.set(a);\r\n    c.set(b, a.length);\r\n    return c;\r\n  }\r\n  throw new Error(\"Unknown data type\");\r\n}\r\n\r\nexport function getSource(input, chunkSize, callback) {\r\n  // In React Native, when user selects a file, instead of a File or Blob,\r\n  // you usually get a file object {} with a uri property that contains\r\n  // a local path to the file. We use XMLHttpRequest to fetch\r\n  // the file blob, before uploading with tus.\r\n  // TODO: The __tus__forceReactNative property is currently used to force\r\n  // a React Native environment during testing. This should be removed\r\n  // once we move away from PhantomJS and can overwrite navigator.product\r\n  // properly.\r\n  if ((isReactNative || window.__tus__forceReactNative) && input && typeof input.uri !== \"undefined\") {\r\n    uriToBlob(input.uri, (err, blob) => {\r\n      if (err) {\r\n        return callback(new Error(\"tus: cannot fetch `file.uri` as Blob, make sure the uri is correct and accessible. \" + err));\r\n      }\r\n      callback(null, new FileSource(blob));\r\n    });\r\n    return;\r\n  }\r\n\r\n  // Since we emulate the Blob type in our tests (not all target browsers\r\n  // support it), we cannot use `instanceof` for testing whether the input value\r\n  // can be handled. Instead, we simply check is the slice() function and the\r\n  // size property are available.\r\n  if (typeof input.slice === \"function\" && typeof input.size !== \"undefined\") {\r\n    callback(null, new FileSource(input));\r\n    return;\r\n  }\r\n\r\n  if (typeof input.read === \"function\") {\r\n    chunkSize = +chunkSize;\r\n    if (!isFinite(chunkSize)) {\r\n      callback(new Error(\"cannot create source for stream without a finite value for the `chunkSize` option\"));\r\n      return;\r\n    }\r\n    callback(null, new StreamSource(input, chunkSize));\r\n    return;\r\n  }\r\n\r\n  callback(new Error(\"source object may only be an instance of File, Blob, or Reader in this environment\"));\r\n}\r\n","/* global window, localStorage */\r\n\r\nlet hasStorage = false;\r\ntry {\r\n  hasStorage = \"localStorage\" in window;\r\n\r\n  // Attempt to store and read entries from the local storage to detect Private\r\n  // Mode on Safari on iOS (see #49)\r\n  var key = \"tusSupport\";\r\n  localStorage.setItem(key, localStorage.getItem(key));\r\n\r\n} catch (e) {\r\n  // If we try to access localStorage inside a sandboxed iframe, a SecurityError\r\n  // is thrown. When in private mode on iOS Safari, a QuotaExceededError is\r\n  // thrown (see #49)\r\n  if (e.code === e.SECURITY_ERR || e.code === e.QUOTA_EXCEEDED_ERR) {\r\n    hasStorage = false;\r\n  } else {\r\n    throw e;\r\n  }\r\n}\r\n\r\nexport const canStoreURLs = hasStorage;\r\n\r\nclass LocalStorage {\r\n  setItem(key, value, cb) {\r\n    cb(null, localStorage.setItem(key, value));\r\n  }\r\n\r\n  getItem(key, cb) {\r\n    cb(null, localStorage.getItem(key));\r\n  }\r\n\r\n  removeItem(key, cb) {\r\n    cb(null, localStorage.removeItem(key));\r\n  }\r\n}\r\n\r\nexport function getStorage() {\r\n  return hasStorage ? new LocalStorage() : null;\r\n}\r\n","/**\r\n * uriToBlob resolves a URI to a Blob object. This is used for\r\n * React Native to retrieve a file (identified by a file://\r\n * URI) as a blob.\r\n */\r\nfunction uriToBlob(uri, done) {\r\n  const xhr = new XMLHttpRequest();\r\n  xhr.responseType = \"blob\";\r\n  xhr.onload = () => {\r\n    const blob = xhr.response;\r\n    done(null, blob);\r\n  };\r\n  xhr.onerror = (err) => {\r\n    done(err);\r\n  };\r\n  xhr.open(\"GET\", uri);\r\n  xhr.send();\r\n}\r\n\r\nexport default uriToBlob;\r\n","class DetailedError extends Error {\r\n  constructor(error, causingErr = null, xhr = null) {\r\n    super(error.message);\r\n\r\n    this.originalRequest = xhr;\r\n    this.causingError = causingErr;\r\n\r\n    let message = error.message;\r\n    if (causingErr != null) {\r\n      message += `, caused by ${causingErr.toString()}`;\r\n    }\r\n    if (xhr != null) {\r\n      message += `, originated from request (response code: ${xhr.status}, response text: ${xhr.responseText})`;\r\n    }\r\n    this.message = message;\r\n  }\r\n}\r\n\r\nexport default DetailedError;\r\n","/* global window */\r\nimport Upload from \"./upload\";\r\nimport * as storage from \"./node/storage\";\r\n\r\nconst {defaultOptions} = Upload;\r\n\r\nconst moduleExport = {\r\n  Upload,\r\n  canStoreURLs: storage.canStoreURLs,\r\n  defaultOptions\r\n};\r\n\r\nif (typeof window !== \"undefined\") {\r\n  // Browser environment using XMLHttpRequest\r\n  const {XMLHttpRequest, Blob} = window;\r\n\r\n  moduleExport.isSupported = (\r\n    XMLHttpRequest &&\r\n    Blob &&\r\n    typeof Blob.prototype.slice === \"function\"\r\n  );\r\n} else {\r\n  // Node.js environment using http module\r\n  moduleExport.isSupported = true;\r\n  // make FileStorage module available as it will not be set by default.\r\n  moduleExport.FileStorage = storage.FileStorage;\r\n}\r\n\r\n// The usage of the commonjs exporting syntax instead of the new ECMAScript\r\n// one is actually inteded and prevents weird behaviour if we are trying to\r\n// import this module in another module using Babel.\r\nmodule.exports = moduleExport;\r\n","/* global window */\r\nimport DetailedError from \"./error\";\r\nimport extend from \"extend\";\r\nimport { Base64 } from \"js-base64\";\r\n\r\n// We import the files used inside the Node environment which are rewritten\r\n// for browsers using the rules defined in the package.json\r\nimport { newRequest, resolveUrl } from \"./node/request\";\r\nimport { getSource } from \"./node/source\";\r\nimport { getStorage } from \"./node/storage\";\r\nimport fingerprint from \"./node/fingerprint\";\r\n\r\nconst defaultOptions = {\r\n  endpoint: null,\r\n  fingerprint,\r\n  resume: true,\r\n  onProgress: null,\r\n  onChunkComplete: null,\r\n  onSuccess: null,\r\n  onError: null,\r\n  headers: {},\r\n  chunkSize: Infinity,\r\n  withCredentials: false,\r\n  uploadUrl: null,\r\n  uploadSize: null,\r\n  overridePatchMethod: false,\r\n  retryDelays: null,\r\n  removeFingerprintOnSuccess: false,\r\n  uploadLengthDeferred: false,\r\n  urlStorage: null,\r\n  fileReader: null\r\n};\r\n\r\nclass Upload {\r\n  constructor(file, options) {\r\n    this.options = extend(true, {}, defaultOptions, options);\r\n\r\n    // The storage module used to store URLs\r\n    this._storage = this.options.urlStorage;\r\n\r\n    // The underlying File/Blob object\r\n    this.file = file;\r\n\r\n    // The URL against which the file will be uploaded\r\n    this.url = null;\r\n\r\n    // The underlying XHR object for the current PATCH request\r\n    this._xhr = null;\r\n\r\n    // The fingerpinrt for the current file (set after start())\r\n    this._fingerprint = null;\r\n\r\n    // The offset used in the current PATCH request\r\n    this._offset = null;\r\n\r\n    // True if the current PATCH request has been aborted\r\n    this._aborted = false;\r\n\r\n    // The file's size in bytes\r\n    this._size = null;\r\n\r\n    // The Source object which will wrap around the given file and provides us\r\n    // with a unified interface for getting its size and slice chunks from its\r\n    // content allowing us to easily handle Files, Blobs, Buffers and Streams.\r\n    this._source = null;\r\n\r\n    // The current count of attempts which have been made. Null indicates none.\r\n    this._retryAttempt = 0;\r\n\r\n    // The timeout's ID which is used to delay the next retry\r\n    this._retryTimeout = null;\r\n\r\n    // The offset of the remote upload before the latest attempt was started.\r\n    this._offsetBeforeRetry = 0;\r\n  }\r\n\r\n  start() {\r\n    let file = this.file;\r\n\r\n    if (!file) {\r\n      this._emitError(new Error(\"tus: no file or stream to upload provided\"));\r\n      return;\r\n    }\r\n\r\n    if (!this.options.endpoint && !this.options.uploadUrl) {\r\n      this._emitError(new Error(\"tus: neither an endpoint or an upload URL is provided\"));\r\n      return;\r\n    }\r\n\r\n    if (this.options.resume && this._storage == null) {\r\n      this._storage = getStorage();\r\n    }\r\n\r\n    if (this._source) {\r\n      this._start(this._source);\r\n    } else {\r\n      const fileReader = this.options.fileReader || getSource;\r\n      fileReader(file, this.options.chunkSize, (err, source) => {\r\n        if (err) {\r\n          this._emitError(err);\r\n          return;\r\n        }\r\n\r\n        this._source = source;\r\n        this._start(source);\r\n      });\r\n    }\r\n  }\r\n\r\n  _start(source) {\r\n    let file = this.file;\r\n\r\n    // First, we look at the uploadLengthDeferred option.\r\n    // Next, we check if the caller has supplied a manual upload size.\r\n    // Finally, we try to use the calculated size from the source object.\r\n    if (this.options.uploadLengthDeferred) {\r\n      this._size = null;\r\n    } else if (this.options.uploadSize != null) {\r\n      this._size = +this.options.uploadSize;\r\n      if (isNaN(this._size)) {\r\n        this._emitError(new Error(\"tus: cannot convert `uploadSize` option into a number\"));\r\n        return;\r\n      }\r\n    } else {\r\n      this._size = source.size;\r\n      if (this._size == null) {\r\n        this._emitError(new Error(\"tus: cannot automatically derive upload's size from input and must be specified manually using the `uploadSize` option\"));\r\n        return;\r\n      }\r\n    }\r\n\r\n    let retryDelays = this.options.retryDelays;\r\n    if (retryDelays != null) {\r\n      if (Object.prototype.toString.call(retryDelays) !== \"[object Array]\") {\r\n        this._emitError(new Error(\"tus: the `retryDelays` option must either be an array or null\"));\r\n        return;\r\n      } else {\r\n        let errorCallback = this.options.onError;\r\n        this.options.onError = (err) => {\r\n          // Restore the original error callback which may have been set.\r\n          this.options.onError = errorCallback;\r\n\r\n          // We will reset the attempt counter if\r\n          // - we were already able to connect to the server (offset != null) and\r\n          // - we were able to upload a small chunk of data to the server\r\n          let shouldResetDelays = this._offset != null && (this._offset > this._offsetBeforeRetry);\r\n          if (shouldResetDelays) {\r\n            this._retryAttempt = 0;\r\n          }\r\n\r\n          let isOnline = true;\r\n          if (typeof window !== \"undefined\" &&\r\n             \"navigator\" in window &&\r\n             window.navigator.onLine === false) {\r\n            isOnline = false;\r\n          }\r\n\r\n          // We only attempt a retry if\r\n          // - we didn't exceed the maxium number of retries, yet, and\r\n          // - this error was caused by a request or it's response and\r\n          // - the error is server error (i.e. no a status 4xx or a 409 or 423) and\r\n          // - the browser does not indicate that we are offline\r\n          let status = err.originalRequest ? err.originalRequest.status : 0;\r\n          let isServerError = !inStatusCategory(status, 400) || status === 409 || status === 423;\r\n          let shouldRetry = this._retryAttempt < retryDelays.length &&\r\n                            err.originalRequest != null &&\r\n                            isServerError &&\r\n                            isOnline;\r\n\r\n          if (!shouldRetry) {\r\n            this._emitError(err);\r\n            return;\r\n          }\r\n\r\n          let delay = retryDelays[this._retryAttempt++];\r\n\r\n          this._offsetBeforeRetry = this._offset;\r\n          this.options.uploadUrl = this.url;\r\n\r\n          this._retryTimeout = setTimeout(() => {\r\n            this.start();\r\n          }, delay);\r\n        };\r\n      }\r\n    }\r\n\r\n    // Reset the aborted flag when the upload is started or else the\r\n    // _startUpload will stop before sending a request if the upload has been\r\n    // aborted previously.\r\n    this._aborted = false;\r\n\r\n    // The upload had been started previously and we should reuse this URL.\r\n    if (this.url != null) {\r\n      this._resumeUpload();\r\n      return;\r\n    }\r\n\r\n    // A URL has manually been specified, so we try to resume\r\n    if (this.options.uploadUrl != null) {\r\n      this.url = this.options.uploadUrl;\r\n      this._resumeUpload();\r\n      return;\r\n    }\r\n\r\n    // Try to find the endpoint for the file in the storage\r\n    if (this._hasStorage()) {\r\n      this.options.fingerprint(file, this.options, (err, fingerprintValue) => {\r\n        if (err) {\r\n          this._emitError(err);\r\n          return;\r\n        }\r\n\r\n        this._fingerprint = fingerprintValue;\r\n        this._storage.getItem(this._fingerprint, (err, resumedUrl) => {\r\n          if (err) {\r\n            this._emitError(err);\r\n            return;\r\n          }\r\n\r\n          if (resumedUrl != null) {\r\n            this.url = resumedUrl;\r\n            this._resumeUpload();\r\n          } else {\r\n            this._createUpload();\r\n          }\r\n        });\r\n      });\r\n    } else {\r\n      // An upload has not started for the file yet, so we start a new one\r\n      this._createUpload();\r\n    }\r\n  }\r\n\r\n  abort() {\r\n    if (this._xhr !== null) {\r\n      this._xhr.abort();\r\n      this._source.close();\r\n    }\r\n    this._aborted = true;\r\n\r\n    if (this._retryTimeout != null) {\r\n      clearTimeout(this._retryTimeout);\r\n      this._retryTimeout = null;\r\n    }\r\n  }\r\n\r\n  _hasStorage() {\r\n    return this.options.resume && this._storage;\r\n  }\r\n\r\n  _emitXhrError(xhr, err, causingErr) {\r\n    this._emitError(new DetailedError(err, causingErr, xhr));\r\n  }\r\n\r\n  _emitError(err) {\r\n    if (typeof this.options.onError === \"function\") {\r\n      this.options.onError(err);\r\n    } else {\r\n      throw err;\r\n    }\r\n  }\r\n\r\n  _emitSuccess() {\r\n    if (typeof this.options.onSuccess === \"function\") {\r\n      this.options.onSuccess();\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Publishes notification when data has been sent to the server. This\r\n   * data may not have been accepted by the server yet.\r\n   * @param  {number} bytesSent  Number of bytes sent to the server.\r\n   * @param  {number} bytesTotal Total number of bytes to be sent to the server.\r\n   */\r\n  _emitProgress(bytesSent, bytesTotal) {\r\n    if (typeof this.options.onProgress === \"function\") {\r\n      this.options.onProgress(bytesSent, bytesTotal);\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Publishes notification when a chunk of data has been sent to the server\r\n   * and accepted by the server.\r\n   * @param  {number} chunkSize  Size of the chunk that was accepted by the\r\n   *                             server.\r\n   * @param  {number} bytesAccepted Total number of bytes that have been\r\n   *                                accepted by the server.\r\n   * @param  {number} bytesTotal Total number of bytes to be sent to the server.\r\n   */\r\n  _emitChunkComplete(chunkSize, bytesAccepted, bytesTotal) {\r\n    if (typeof this.options.onChunkComplete === \"function\") {\r\n      this.options.onChunkComplete(chunkSize, bytesAccepted, bytesTotal);\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Set the headers used in the request and the withCredentials property\r\n   * as defined in the options\r\n   *\r\n   * @param {XMLHttpRequest} xhr\r\n   */\r\n  _setupXHR(xhr) {\r\n    this._xhr = xhr;\r\n\r\n    xhr.setRequestHeader(\"Tus-Resumable\", \"1.0.0\");\r\n    let headers = this.options.headers;\r\n\r\n    for (let name in headers) {\r\n      xhr.setRequestHeader(name, headers[name]);\r\n    }\r\n\r\n    xhr.withCredentials = this.options.withCredentials;\r\n  }\r\n\r\n  /**\r\n   * Create a new upload using the creation extension by sending a POST\r\n   * request to the endpoint. After successful creation the file will be\r\n   * uploaded\r\n   *\r\n   * @api private\r\n   */\r\n  _createUpload() {\r\n    if (!this.options.endpoint) {\r\n      this._emitError(new Error(\"tus: unable to create upload because no endpoint is provided\"));\r\n      return;\r\n    }\r\n\r\n    let xhr = newRequest();\r\n    xhr.open(\"POST\", this.options.endpoint, true);\r\n\r\n    xhr.onload = () => {\r\n      if (!inStatusCategory(xhr.status, 200)) {\r\n        this._emitXhrError(xhr, new Error(\"tus: unexpected response while creating upload\"));\r\n        return;\r\n      }\r\n\r\n      let location = xhr.getResponseHeader(\"Location\");\r\n      if (location == null) {\r\n        this._emitXhrError(xhr, new Error(\"tus: invalid or missing Location header\"));\r\n        return;\r\n      }\r\n\r\n      this.url = resolveUrl(this.options.endpoint, location);\r\n\r\n      if (this._size === 0) {\r\n        // Nothing to upload and file was successfully created\r\n        this._emitSuccess();\r\n        this._source.close();\r\n        return;\r\n      }\r\n\r\n      if (this._hasStorage()) {\r\n        this._storage.setItem(this._fingerprint, this.url, (err) => {\r\n          if (err) {\r\n            this._emitError(err);\r\n          }\r\n        });\r\n      }\r\n\r\n      this._offset = 0;\r\n      this._startUpload();\r\n    };\r\n\r\n    xhr.onerror = (err) => {\r\n      this._emitXhrError(xhr, new Error(\"tus: failed to create upload\"), err);\r\n    };\r\n\r\n    this._setupXHR(xhr);\r\n    if (this.options.uploadLengthDeferred) {\r\n      xhr.setRequestHeader(\"Upload-Defer-Length\", 1);\r\n    } else {\r\n      xhr.setRequestHeader(\"Upload-Length\", this._size);\r\n    }\r\n\r\n    // Add metadata if values have been added\r\n    var metadata = encodeMetadata(this.options.metadata);\r\n    if (metadata !== \"\") {\r\n      xhr.setRequestHeader(\"Upload-Metadata\", metadata);\r\n    }\r\n\r\n    xhr.send(null);\r\n  }\r\n\r\n  /*\r\n   * Try to resume an existing upload. First a HEAD request will be sent\r\n   * to retrieve the offset. If the request fails a new upload will be\r\n   * created. In the case of a successful response the file will be uploaded.\r\n   *\r\n   * @api private\r\n   */\r\n  _resumeUpload() {\r\n    let xhr = newRequest();\r\n    xhr.open(\"GET\", this.url, true);\r\n\r\n    xhr.onload = () => {\r\n      if (!inStatusCategory(xhr.status, 200)) {\r\n        if (this._hasStorage() && inStatusCategory(xhr.status, 400)) {\r\n          // Remove stored fingerprint and corresponding endpoint,\r\n          // on client errors since the file can not be found\r\n          this._storage.removeItem(this._fingerprint, (err) => {\r\n            if (err) {\r\n              this._emitError(err);\r\n            }\r\n          });\r\n        }\r\n\r\n        // If the upload is locked (indicated by the 423 Locked status code), we\r\n        // emit an error instead of directly starting a new upload. This way the\r\n        // retry logic can catch the error and will retry the upload. An upload\r\n        // is usually locked for a short period of time and will be available\r\n        // afterwards.\r\n        if (xhr.status === 423) {\r\n          this._emitXhrError(xhr, new Error(\"tus: upload is currently locked; retry later\"));\r\n          return;\r\n        }\r\n\r\n        if (!this.options.endpoint) {\r\n          // Don't attempt to create a new upload if no endpoint is provided.\r\n          this._emitXhrError(xhr, new Error(\"tus: unable to resume upload (new upload cannot be created without an endpoint)\"));\r\n          return;\r\n        }\r\n\r\n        // Try to create a new upload\r\n        this.url = null;\r\n        this._createUpload();\r\n        return;\r\n      }\r\n\r\n      let offset = parseInt(xhr.getResponseHeader(\"Upload-Offset\"), 10);\r\n      if (isNaN(offset)) {\r\n        this._emitXhrError(xhr, new Error(\"tus: invalid or missing offset value\"));\r\n        return;\r\n      }\r\n\r\n      let length = parseInt(xhr.getResponseHeader(\"Upload-Length\"), 10);\r\n      if (isNaN(length) && !this.options.uploadLengthDeferred) {\r\n        this._emitXhrError(xhr, new Error(\"tus: invalid or missing length value\"));\r\n        return;\r\n      }\r\n\r\n      // Upload has already been completed and we do not need to send additional\r\n      // data to the server\r\n      if (offset === length) {\r\n        this._emitProgress(length, length);\r\n        this._emitSuccess();\r\n        return;\r\n      }\r\n\r\n      this._offset = offset;\r\n      this._startUpload();\r\n    };\r\n\r\n    xhr.onerror = (err) => {\r\n      this._emitXhrError(xhr, new Error(\"tus: failed to resume upload\"), err);\r\n    };\r\n\r\n    this._setupXHR(xhr);\r\n    xhr.send(null);\r\n  }\r\n\r\n  /**\r\n   * Start uploading the file using PATCH requests. The file will be divided\r\n   * into chunks as specified in the chunkSize option. During the upload\r\n   * the onProgress event handler may be invoked multiple times.\r\n   *\r\n   * @api private\r\n   */\r\n  _startUpload() {\r\n    // If the upload has been aborted, we will not send the next PATCH request.\r\n    // This is important if the abort method was called during a callback, such\r\n    // as onChunkComplete or onProgress.\r\n    if (this._aborted) {\r\n      return;\r\n    }\r\n\r\n    let xhr = newRequest();\r\n\r\n    // Some browser and servers may not support the PATCH method. For those\r\n    // cases, you can tell tus-js-client to use a POST request with the\r\n    // X-HTTP-Method-Override header for simulating a PATCH request.\r\n    if (this.options.overridePatchMethod) {\r\n      xhr.open(\"POST\", this.url, true);\r\n      xhr.setRequestHeader(\"X-HTTP-Method-Override\", \"PATCH\");\r\n    } else {\r\n      xhr.open(\"PATCH\", this.url, true);\r\n    }\r\n\r\n    xhr.onload = () => {\r\n      if (!inStatusCategory(xhr.status, 200)) {\r\n        this._emitXhrError(xhr, new Error(\"tus: unexpected response while uploading chunk\"));\r\n        return;\r\n      }\r\n\r\n      let offset = parseInt(xhr.getResponseHeader(\"Upload-Offset\"), 10);\r\n      if (isNaN(offset)) {\r\n        this._emitXhrError(xhr, new Error(\"tus: invalid or missing offset value\"));\r\n        return;\r\n      }\r\n\r\n      this._emitProgress(offset, this._size);\r\n      this._emitChunkComplete(offset - this._offset, offset, this._size);\r\n\r\n      this._offset = offset;\r\n\r\n      if (offset == this._size) {\r\n        if (this.options.removeFingerprintOnSuccess && this.options.resume) {\r\n          // Remove stored fingerprint and corresponding endpoint. This causes\r\n          // new upload of the same file must be treated as a different file.\r\n          this._storage.removeItem(this._fingerprint, (err) => {\r\n            if (err) {\r\n              this._emitError(err);\r\n            }\r\n          });\r\n        }\r\n\r\n        // Yay, finally done :)\r\n        this._emitSuccess();\r\n        this._source.close();\r\n        return;\r\n      }\r\n\r\n      this._startUpload();\r\n    };\r\n\r\n    xhr.onerror = (err) => {\r\n      // Don't emit an error if the upload was aborted manually\r\n      if (this._aborted) {\r\n        return;\r\n      }\r\n\r\n      this._emitXhrError(xhr, new Error(\"tus: failed to upload chunk at offset \" + this._offset), err);\r\n    };\r\n\r\n    // Test support for progress events before attaching an event listener\r\n    if (\"upload\" in xhr) {\r\n      xhr.upload.onprogress = (e) => {\r\n        if (!e.lengthComputable) {\r\n          return;\r\n        }\r\n\r\n        this._emitProgress(start + e.loaded, this._size);\r\n      };\r\n    }\r\n\r\n    this._setupXHR(xhr);\r\n\r\n    xhr.setRequestHeader(\"Upload-Offset\", this._offset);\r\n    xhr.setRequestHeader(\"Content-Type\", \"application/offset+octet-stream\");\r\n\r\n    let start = this._offset;\r\n    let end = this._offset + this.options.chunkSize;\r\n\r\n    // The specified chunkSize may be Infinity or the calcluated end position\r\n    // may exceed the file's size. In both cases, we limit the end position to\r\n    // the input's total size for simpler calculations and correctness.\r\n    if ((end === Infinity || end > this._size) && !this.options.uploadLengthDeferred) {\r\n      end = this._size;\r\n    }\r\n\r\n    this._source.slice(start, end, (err, value, complete) => {\r\n      if (err) {\r\n        this._emitError(err);\r\n        return;\r\n      }\r\n\r\n      if (this.options.uploadLengthDeferred) {\r\n        if (complete) {\r\n          this._size = this._offset + (value && value.size ? value.size : 0);\r\n          xhr.setRequestHeader(\"Upload-Length\", this._size);\r\n        }\r\n      }\r\n\r\n      if (value === null) {\r\n        xhr.send();\r\n      } else {\r\n        xhr.send(value);\r\n        this._emitProgress(this._offset, this._size);\r\n      }\r\n    });\r\n  }\r\n}\r\n\r\nfunction encodeMetadata(metadata) {\r\n  var encoded = [];\r\n\r\n  for (var key in metadata) {\r\n    encoded.push(key + \" \" + Base64.encode(metadata[key]));\r\n  }\r\n\r\n  return encoded.join(\",\");\r\n}\r\n\r\n/**\r\n * Checks whether a given status is in the range of the expected category.\r\n * For example, only a status between 200 and 299 will satisfy the category 200.\r\n *\r\n * @api private\r\n */\r\nfunction inStatusCategory(status, category) {\r\n  return (status >= category && status < (category + 100));\r\n}\r\n\r\nUpload.defaultOptions = defaultOptions;\r\n\r\nexport default Upload;\r\n","'use strict';\n\nvar hasOwn = Object.prototype.hasOwnProperty;\nvar toStr = Object.prototype.toString;\nvar defineProperty = Object.defineProperty;\nvar gOPD = Object.getOwnPropertyDescriptor;\n\nvar isArray = function isArray(arr) {\n\tif (typeof Array.isArray === 'function') {\n\t\treturn Array.isArray(arr);\n\t}\n\n\treturn toStr.call(arr) === '[object Array]';\n};\n\nvar isPlainObject = function isPlainObject(obj) {\n\tif (!obj || toStr.call(obj) !== '[object Object]') {\n\t\treturn false;\n\t}\n\n\tvar hasOwnConstructor = hasOwn.call(obj, 'constructor');\n\tvar hasIsPrototypeOf = obj.constructor && obj.constructor.prototype && hasOwn.call(obj.constructor.prototype, 'isPrototypeOf');\n\t// Not own constructor property must be Object\n\tif (obj.constructor && !hasOwnConstructor && !hasIsPrototypeOf) {\n\t\treturn false;\n\t}\n\n\t// Own properties are enumerated firstly, so to speed up,\n\t// if last one is own, then all properties are own.\n\tvar key;\n\tfor (key in obj) { /**/ }\n\n\treturn typeof key === 'undefined' || hasOwn.call(obj, key);\n};\n\n// If name is '__proto__', and Object.defineProperty is available, define __proto__ as an own property on target\nvar setProperty = function setProperty(target, options) {\n\tif (defineProperty && options.name === '__proto__') {\n\t\tdefineProperty(target, options.name, {\n\t\t\tenumerable: true,\n\t\t\tconfigurable: true,\n\t\t\tvalue: options.newValue,\n\t\t\twritable: true\n\t\t});\n\t} else {\n\t\ttarget[options.name] = options.newValue;\n\t}\n};\n\n// Return undefined instead of __proto__ if '__proto__' is not an own property\nvar getProperty = function getProperty(obj, name) {\n\tif (name === '__proto__') {\n\t\tif (!hasOwn.call(obj, name)) {\n\t\t\treturn void 0;\n\t\t} else if (gOPD) {\n\t\t\t// In early versions of node, obj['__proto__'] is buggy when obj has\n\t\t\t// __proto__ as an own property. Object.getOwnPropertyDescriptor() works.\n\t\t\treturn gOPD(obj, name).value;\n\t\t}\n\t}\n\n\treturn obj[name];\n};\n\nmodule.exports = function extend() {\n\tvar options, name, src, copy, copyIsArray, clone;\n\tvar target = arguments[0];\n\tvar i = 1;\n\tvar length = arguments.length;\n\tvar deep = false;\n\n\t// Handle a deep copy situation\n\tif (typeof target === 'boolean') {\n\t\tdeep = target;\n\t\ttarget = arguments[1] || {};\n\t\t// skip the boolean and the target\n\t\ti = 2;\n\t}\n\tif (target == null || (typeof target !== 'object' && typeof target !== 'function')) {\n\t\ttarget = {};\n\t}\n\n\tfor (; i < length; ++i) {\n\t\toptions = arguments[i];\n\t\t// Only deal with non-null/undefined values\n\t\tif (options != null) {\n\t\t\t// Extend the base object\n\t\t\tfor (name in options) {\n\t\t\t\tsrc = getProperty(target, name);\n\t\t\t\tcopy = getProperty(options, name);\n\n\t\t\t\t// Prevent never-ending loop\n\t\t\t\tif (target !== copy) {\n\t\t\t\t\t// Recurse if we're merging plain objects or arrays\n\t\t\t\t\tif (deep && copy && (isPlainObject(copy) || (copyIsArray = isArray(copy)))) {\n\t\t\t\t\t\tif (copyIsArray) {\n\t\t\t\t\t\t\tcopyIsArray = false;\n\t\t\t\t\t\t\tclone = src && isArray(src) ? src : [];\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\tclone = src && isPlainObject(src) ? src : {};\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\t// Never move original objects, clone them\n\t\t\t\t\t\tsetProperty(target, { name: name, newValue: extend(deep, clone, copy) });\n\n\t\t\t\t\t// Don't bring in undefined values\n\t\t\t\t\t} else if (typeof copy !== 'undefined') {\n\t\t\t\t\t\tsetProperty(target, { name: name, newValue: copy });\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\n\t// Return the modified object\n\treturn target;\n};\n","/*\n *  base64.js\n *\n *  Licensed under the BSD 3-Clause License.\n *    http://opensource.org/licenses/BSD-3-Clause\n *\n *  References:\n *    http://en.wikipedia.org/wiki/Base64\n */\n;(function (global, factory) {\n    typeof exports === 'object' && typeof module !== 'undefined'\n        ? module.exports = factory(global)\n        : typeof define === 'function' && define.amd\n        ? define(factory) : factory(global)\n}((\n    typeof self !== 'undefined' ? self\n        : typeof window !== 'undefined' ? window\n        : typeof global !== 'undefined' ? global\n: this\n), function(global) {\n    'use strict';\n    // existing version for noConflict()\n    var _Base64 = global.Base64;\n    var version = \"2.4.9\";\n    // if node.js and NOT React Native, we use Buffer\n    var buffer;\n    if (typeof module !== 'undefined' && module.exports) {\n        try {\n            buffer = eval(\"require('buffer').Buffer\");\n        } catch (err) {\n            buffer = undefined;\n        }\n    }\n    // constants\n    var b64chars\n        = 'ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/';\n    var b64tab = function(bin) {\n        var t = {};\n        for (var i = 0, l = bin.length; i < l; i++) t[bin.charAt(i)] = i;\n        return t;\n    }(b64chars);\n    var fromCharCode = String.fromCharCode;\n    // encoder stuff\n    var cb_utob = function(c) {\n        if (c.length < 2) {\n            var cc = c.charCodeAt(0);\n            return cc < 0x80 ? c\n                : cc < 0x800 ? (fromCharCode(0xc0 | (cc >>> 6))\n                                + fromCharCode(0x80 | (cc & 0x3f)))\n                : (fromCharCode(0xe0 | ((cc >>> 12) & 0x0f))\n                   + fromCharCode(0x80 | ((cc >>>  6) & 0x3f))\n                   + fromCharCode(0x80 | ( cc         & 0x3f)));\n        } else {\n            var cc = 0x10000\n                + (c.charCodeAt(0) - 0xD800) * 0x400\n                + (c.charCodeAt(1) - 0xDC00);\n            return (fromCharCode(0xf0 | ((cc >>> 18) & 0x07))\n                    + fromCharCode(0x80 | ((cc >>> 12) & 0x3f))\n                    + fromCharCode(0x80 | ((cc >>>  6) & 0x3f))\n                    + fromCharCode(0x80 | ( cc         & 0x3f)));\n        }\n    };\n    var re_utob = /[\\uD800-\\uDBFF][\\uDC00-\\uDFFFF]|[^\\x00-\\x7F]/g;\n    var utob = function(u) {\n        return u.replace(re_utob, cb_utob);\n    };\n    var cb_encode = function(ccc) {\n        var padlen = [0, 2, 1][ccc.length % 3],\n        ord = ccc.charCodeAt(0) << 16\n            | ((ccc.length > 1 ? ccc.charCodeAt(1) : 0) << 8)\n            | ((ccc.length > 2 ? ccc.charCodeAt(2) : 0)),\n        chars = [\n            b64chars.charAt( ord >>> 18),\n            b64chars.charAt((ord >>> 12) & 63),\n            padlen >= 2 ? '=' : b64chars.charAt((ord >>> 6) & 63),\n            padlen >= 1 ? '=' : b64chars.charAt(ord & 63)\n        ];\n        return chars.join('');\n    };\n    var btoa = global.btoa ? function(b) {\n        return global.btoa(b);\n    } : function(b) {\n        return b.replace(/[\\s\\S]{1,3}/g, cb_encode);\n    };\n    var _encode = buffer ?\n        buffer.from && Uint8Array && buffer.from !== Uint8Array.from\n        ? function (u) {\n            return (u.constructor === buffer.constructor ? u : buffer.from(u))\n                .toString('base64')\n        }\n        :  function (u) {\n            return (u.constructor === buffer.constructor ? u : new  buffer(u))\n                .toString('base64')\n        }\n        : function (u) { return btoa(utob(u)) }\n    ;\n    var encode = function(u, urisafe) {\n        return !urisafe\n            ? _encode(String(u))\n            : _encode(String(u)).replace(/[+\\/]/g, function(m0) {\n                return m0 == '+' ? '-' : '_';\n            }).replace(/=/g, '');\n    };\n    var encodeURI = function(u) { return encode(u, true) };\n    // decoder stuff\n    var re_btou = new RegExp([\n        '[\\xC0-\\xDF][\\x80-\\xBF]',\n        '[\\xE0-\\xEF][\\x80-\\xBF]{2}',\n        '[\\xF0-\\xF7][\\x80-\\xBF]{3}'\n    ].join('|'), 'g');\n    var cb_btou = function(cccc) {\n        switch(cccc.length) {\n        case 4:\n            var cp = ((0x07 & cccc.charCodeAt(0)) << 18)\n                |    ((0x3f & cccc.charCodeAt(1)) << 12)\n                |    ((0x3f & cccc.charCodeAt(2)) <<  6)\n                |     (0x3f & cccc.charCodeAt(3)),\n            offset = cp - 0x10000;\n            return (fromCharCode((offset  >>> 10) + 0xD800)\n                    + fromCharCode((offset & 0x3FF) + 0xDC00));\n        case 3:\n            return fromCharCode(\n                ((0x0f & cccc.charCodeAt(0)) << 12)\n                    | ((0x3f & cccc.charCodeAt(1)) << 6)\n                    |  (0x3f & cccc.charCodeAt(2))\n            );\n        default:\n            return  fromCharCode(\n                ((0x1f & cccc.charCodeAt(0)) << 6)\n                    |  (0x3f & cccc.charCodeAt(1))\n            );\n        }\n    };\n    var btou = function(b) {\n        return b.replace(re_btou, cb_btou);\n    };\n    var cb_decode = function(cccc) {\n        var len = cccc.length,\n        padlen = len % 4,\n        n = (len > 0 ? b64tab[cccc.charAt(0)] << 18 : 0)\n            | (len > 1 ? b64tab[cccc.charAt(1)] << 12 : 0)\n            | (len > 2 ? b64tab[cccc.charAt(2)] <<  6 : 0)\n            | (len > 3 ? b64tab[cccc.charAt(3)]       : 0),\n        chars = [\n            fromCharCode( n >>> 16),\n            fromCharCode((n >>>  8) & 0xff),\n            fromCharCode( n         & 0xff)\n        ];\n        chars.length -= [0, 0, 2, 1][padlen];\n        return chars.join('');\n    };\n    var atob = global.atob ? function(a) {\n        return global.atob(a);\n    } : function(a){\n        return a.replace(/[\\s\\S]{1,4}/g, cb_decode);\n    };\n    var _decode = buffer ?\n        buffer.from && Uint8Array && buffer.from !== Uint8Array.from\n        ? function(a) {\n            return (a.constructor === buffer.constructor\n                    ? a : buffer.from(a, 'base64')).toString();\n        }\n        : function(a) {\n            return (a.constructor === buffer.constructor\n                    ? a : new buffer(a, 'base64')).toString();\n        }\n        : function(a) { return btou(atob(a)) };\n    var decode = function(a){\n        return _decode(\n            String(a).replace(/[-_]/g, function(m0) { return m0 == '-' ? '+' : '/' })\n                .replace(/[^A-Za-z0-9\\+\\/]/g, '')\n        );\n    };\n    var noConflict = function() {\n        var Base64 = global.Base64;\n        global.Base64 = _Base64;\n        return Base64;\n    };\n    // export Base64\n    global.Base64 = {\n        VERSION: version,\n        atob: atob,\n        btoa: btoa,\n        fromBase64: decode,\n        toBase64: encode,\n        utob: utob,\n        encode: encode,\n        encodeURI: encodeURI,\n        btou: btou,\n        decode: decode,\n        noConflict: noConflict,\n        __buffer__: buffer\n    };\n    // if ES5 is available, make Base64.extendString() available\n    if (typeof Object.defineProperty === 'function') {\n        var noEnum = function(v){\n            return {value:v,enumerable:false,writable:true,configurable:true};\n        };\n        global.Base64.extendString = function () {\n            Object.defineProperty(\n                String.prototype, 'fromBase64', noEnum(function () {\n                    return decode(this)\n                }));\n            Object.defineProperty(\n                String.prototype, 'toBase64', noEnum(function (urisafe) {\n                    return encode(this, urisafe)\n                }));\n            Object.defineProperty(\n                String.prototype, 'toBase64URI', noEnum(function () {\n                    return encode(this, true)\n                }));\n        };\n    }\n    //\n    // export Base64 to the namespace\n    //\n    if (global['Meteor']) { // Meteor.js\n        Base64 = global.Base64;\n    }\n    // module.exports and AMD are mutually exclusive.\n    // module.exports has precedence.\n    if (typeof module !== 'undefined' && module.exports) {\n        module.exports.Base64 = global.Base64;\n    }\n    else if (typeof define === 'function' && define.amd) {\n        // AMD. Register as an anonymous module.\n        define([], function(){ return global.Base64 });\n    }\n    // that's it!\n    return {Base64: global.Base64}\n}));\n","'use strict';\n\nvar has = Object.prototype.hasOwnProperty;\n\n/**\n * Decode a URI encoded string.\n *\n * @param {String} input The URI encoded string.\n * @returns {String} The decoded string.\n * @api private\n */\nfunction decode(input) {\n  return decodeURIComponent(input.replace(/\\+/g, ' '));\n}\n\n/**\n * Simple query string parser.\n *\n * @param {String} query The query string that needs to be parsed.\n * @returns {Object}\n * @api public\n */\nfunction querystring(query) {\n  var parser = /([^=?&]+)=?([^&]*)/g\n    , result = {}\n    , part;\n\n  while (part = parser.exec(query)) {\n    var key = decode(part[1])\n      , value = decode(part[2]);\n\n    //\n    // Prevent overriding of existing properties. This ensures that build-in\n    // methods like `toString` or __proto__ are not overriden by malicious\n    // querystrings.\n    //\n    if (key in result) continue;\n    result[key] = value;\n  }\n\n  return result;\n}\n\n/**\n * Transform a query string to an object.\n *\n * @param {Object} obj Object that should be transformed.\n * @param {String} prefix Optional prefix.\n * @returns {String}\n * @api public\n */\nfunction querystringify(obj, prefix) {\n  prefix = prefix || '';\n\n  var pairs = [];\n\n  //\n  // Optionally prefix with a '?' if needed\n  //\n  if ('string' !== typeof prefix) prefix = '?';\n\n  for (var key in obj) {\n    if (has.call(obj, key)) {\n      pairs.push(encodeURIComponent(key) +'='+ encodeURIComponent(obj[key]));\n    }\n  }\n\n  return pairs.length ? prefix + pairs.join('&') : '';\n}\n\n//\n// Expose the module.\n//\nexports.stringify = querystringify;\nexports.parse = querystring;\n","'use strict';\n\n/**\n * Check if we're required to add a port number.\n *\n * @see https://url.spec.whatwg.org/#default-port\n * @param {Number|String} port Port number we need to check\n * @param {String} protocol Protocol we need to check against.\n * @returns {Boolean} Is it a default port for the given protocol\n * @api private\n */\nmodule.exports = function required(port, protocol) {\n  protocol = protocol.split(':')[0];\n  port = +port;\n\n  if (!port) return false;\n\n  switch (protocol) {\n    case 'http':\n    case 'ws':\n    return port !== 80;\n\n    case 'https':\n    case 'wss':\n    return port !== 443;\n\n    case 'ftp':\n    return port !== 21;\n\n    case 'gopher':\n    return port !== 70;\n\n    case 'file':\n    return false;\n  }\n\n  return port !== 0;\n};\n","'use strict';\n\nvar required = require('requires-port')\n  , qs = require('querystringify')\n  , protocolre = /^([a-z][a-z0-9.+-]*:)?(\\/\\/)?([\\S\\s]*)/i\n  , slashes = /^[A-Za-z][A-Za-z0-9+-.]*:\\/\\//;\n\n/**\n * These are the parse rules for the URL parser, it informs the parser\n * about:\n *\n * 0. The char it Needs to parse, if it's a string it should be done using\n *    indexOf, RegExp using exec and NaN means set as current value.\n * 1. The property we should set when parsing this value.\n * 2. Indication if it's backwards or forward parsing, when set as number it's\n *    the value of extra chars that should be split off.\n * 3. Inherit from location if non existing in the parser.\n * 4. `toLowerCase` the resulting value.\n */\nvar rules = [\n  ['#', 'hash'],                        // Extract from the back.\n  ['?', 'query'],                       // Extract from the back.\n  function sanitize(address) {          // Sanitize what is left of the address\n    return address.replace('\\\\', '/');\n  },\n  ['/', 'pathname'],                    // Extract from the back.\n  ['@', 'auth', 1],                     // Extract from the front.\n  [NaN, 'host', undefined, 1, 1],       // Set left over value.\n  [/:(\\d+)$/, 'port', undefined, 1],    // RegExp the back.\n  [NaN, 'hostname', undefined, 1, 1]    // Set left over.\n];\n\n/**\n * These properties should not be copied or inherited from. This is only needed\n * for all non blob URL's as a blob URL does not include a hash, only the\n * origin.\n *\n * @type {Object}\n * @private\n */\nvar ignore = { hash: 1, query: 1 };\n\n/**\n * The location object differs when your code is loaded through a normal page,\n * Worker or through a worker using a blob. And with the blobble begins the\n * trouble as the location object will contain the URL of the blob, not the\n * location of the page where our code is loaded in. The actual origin is\n * encoded in the `pathname` so we can thankfully generate a good \"default\"\n * location from it so we can generate proper relative URL's again.\n *\n * @param {Object|String} loc Optional default location object.\n * @returns {Object} lolcation object.\n * @public\n */\nfunction lolcation(loc) {\n  var location = global && global.location || {};\n  loc = loc || location;\n\n  var finaldestination = {}\n    , type = typeof loc\n    , key;\n\n  if ('blob:' === loc.protocol) {\n    finaldestination = new Url(unescape(loc.pathname), {});\n  } else if ('string' === type) {\n    finaldestination = new Url(loc, {});\n    for (key in ignore) delete finaldestination[key];\n  } else if ('object' === type) {\n    for (key in loc) {\n      if (key in ignore) continue;\n      finaldestination[key] = loc[key];\n    }\n\n    if (finaldestination.slashes === undefined) {\n      finaldestination.slashes = slashes.test(loc.href);\n    }\n  }\n\n  return finaldestination;\n}\n\n/**\n * @typedef ProtocolExtract\n * @type Object\n * @property {String} protocol Protocol matched in the URL, in lowercase.\n * @property {Boolean} slashes `true` if protocol is followed by \"//\", else `false`.\n * @property {String} rest Rest of the URL that is not part of the protocol.\n */\n\n/**\n * Extract protocol information from a URL with/without double slash (\"//\").\n *\n * @param {String} address URL we want to extract from.\n * @return {ProtocolExtract} Extracted information.\n * @private\n */\nfunction extractProtocol(address) {\n  var match = protocolre.exec(address);\n\n  return {\n    protocol: match[1] ? match[1].toLowerCase() : '',\n    slashes: !!match[2],\n    rest: match[3]\n  };\n}\n\n/**\n * Resolve a relative URL pathname against a base URL pathname.\n *\n * @param {String} relative Pathname of the relative URL.\n * @param {String} base Pathname of the base URL.\n * @return {String} Resolved pathname.\n * @private\n */\nfunction resolve(relative, base) {\n  var path = (base || '/').split('/').slice(0, -1).concat(relative.split('/'))\n    , i = path.length\n    , last = path[i - 1]\n    , unshift = false\n    , up = 0;\n\n  while (i--) {\n    if (path[i] === '.') {\n      path.splice(i, 1);\n    } else if (path[i] === '..') {\n      path.splice(i, 1);\n      up++;\n    } else if (up) {\n      if (i === 0) unshift = true;\n      path.splice(i, 1);\n      up--;\n    }\n  }\n\n  if (unshift) path.unshift('');\n  if (last === '.' || last === '..') path.push('');\n\n  return path.join('/');\n}\n\n/**\n * The actual URL instance. Instead of returning an object we've opted-in to\n * create an actual constructor as it's much more memory efficient and\n * faster and it pleases my OCD.\n *\n * It is worth noting that we should not use `URL` as class name to prevent\n * clashes with the global URL instance that got introduced in browsers.\n *\n * @constructor\n * @param {String} address URL we want to parse.\n * @param {Object|String} location Location defaults for relative paths.\n * @param {Boolean|Function} parser Parser for the query string.\n * @private\n */\nfunction Url(address, location, parser) {\n  if (!(this instanceof Url)) {\n    return new Url(address, location, parser);\n  }\n\n  var relative, extracted, parse, instruction, index, key\n    , instructions = rules.slice()\n    , type = typeof location\n    , url = this\n    , i = 0;\n\n  //\n  // The following if statements allows this module two have compatibility with\n  // 2 different API:\n  //\n  // 1. Node.js's `url.parse` api which accepts a URL, boolean as arguments\n  //    where the boolean indicates that the query string should also be parsed.\n  //\n  // 2. The `URL` interface of the browser which accepts a URL, object as\n  //    arguments. The supplied object will be used as default values / fall-back\n  //    for relative paths.\n  //\n  if ('object' !== type && 'string' !== type) {\n    parser = location;\n    location = null;\n  }\n\n  if (parser && 'function' !== typeof parser) parser = qs.parse;\n\n  location = lolcation(location);\n\n  //\n  // Extract protocol information before running the instructions.\n  //\n  extracted = extractProtocol(address || '');\n  relative = !extracted.protocol && !extracted.slashes;\n  url.slashes = extracted.slashes || relative && location.slashes;\n  url.protocol = extracted.protocol || location.protocol || '';\n  address = extracted.rest;\n\n  //\n  // When the authority component is absent the URL starts with a path\n  // component.\n  //\n  if (!extracted.slashes) instructions[3] = [/(.*)/, 'pathname'];\n\n  for (; i < instructions.length; i++) {\n    instruction = instructions[i];\n\n    if (typeof instruction === 'function') {\n      address = instruction(address);\n      continue;\n    }\n\n    parse = instruction[0];\n    key = instruction[1];\n\n    if (parse !== parse) {\n      url[key] = address;\n    } else if ('string' === typeof parse) {\n      if (~(index = address.indexOf(parse))) {\n        if ('number' === typeof instruction[2]) {\n          url[key] = address.slice(0, index);\n          address = address.slice(index + instruction[2]);\n        } else {\n          url[key] = address.slice(index);\n          address = address.slice(0, index);\n        }\n      }\n    } else if ((index = parse.exec(address))) {\n      url[key] = index[1];\n      address = address.slice(0, index.index);\n    }\n\n    url[key] = url[key] || (\n      relative && instruction[3] ? location[key] || '' : ''\n    );\n\n    //\n    // Hostname, host and protocol should be lowercased so they can be used to\n    // create a proper `origin`.\n    //\n    if (instruction[4]) url[key] = url[key].toLowerCase();\n  }\n\n  //\n  // Also parse the supplied query string in to an object. If we're supplied\n  // with a custom parser as function use that instead of the default build-in\n  // parser.\n  //\n  if (parser) url.query = parser(url.query);\n\n  //\n  // If the URL is relative, resolve the pathname against the base URL.\n  //\n  if (\n      relative\n    && location.slashes\n    && url.pathname.charAt(0) !== '/'\n    && (url.pathname !== '' || location.pathname !== '')\n  ) {\n    url.pathname = resolve(url.pathname, location.pathname);\n  }\n\n  //\n  // We should not add port numbers if they are already the default port number\n  // for a given protocol. As the host also contains the port number we're going\n  // override it with the hostname which contains no port number.\n  //\n  if (!required(url.port, url.protocol)) {\n    url.host = url.hostname;\n    url.port = '';\n  }\n\n  //\n  // Parse down the `auth` for the username and password.\n  //\n  url.username = url.password = '';\n  if (url.auth) {\n    instruction = url.auth.split(':');\n    url.username = instruction[0] || '';\n    url.password = instruction[1] || '';\n  }\n\n  url.origin = url.protocol && url.host && url.protocol !== 'file:'\n    ? url.protocol +'//'+ url.host\n    : 'null';\n\n  //\n  // The href is just the compiled result.\n  //\n  url.href = url.toString();\n}\n\n/**\n * This is convenience method for changing properties in the URL instance to\n * insure that they all propagate correctly.\n *\n * @param {String} part          Property we need to adjust.\n * @param {Mixed} value          The newly assigned value.\n * @param {Boolean|Function} fn  When setting the query, it will be the function\n *                               used to parse the query.\n *                               When setting the protocol, double slash will be\n *                               removed from the final url if it is true.\n * @returns {URL} URL instance for chaining.\n * @public\n */\nfunction set(part, value, fn) {\n  var url = this;\n\n  switch (part) {\n    case 'query':\n      if ('string' === typeof value && value.length) {\n        value = (fn || qs.parse)(value);\n      }\n\n      url[part] = value;\n      break;\n\n    case 'port':\n      url[part] = value;\n\n      if (!required(value, url.protocol)) {\n        url.host = url.hostname;\n        url[part] = '';\n      } else if (value) {\n        url.host = url.hostname +':'+ value;\n      }\n\n      break;\n\n    case 'hostname':\n      url[part] = value;\n\n      if (url.port) value += ':'+ url.port;\n      url.host = value;\n      break;\n\n    case 'host':\n      url[part] = value;\n\n      if (/:\\d+$/.test(value)) {\n        value = value.split(':');\n        url.port = value.pop();\n        url.hostname = value.join(':');\n      } else {\n        url.hostname = value;\n        url.port = '';\n      }\n\n      break;\n\n    case 'protocol':\n      url.protocol = value.toLowerCase();\n      url.slashes = !fn;\n      break;\n\n    case 'pathname':\n    case 'hash':\n      if (value) {\n        var char = part === 'pathname' ? '/' : '#';\n        url[part] = value.charAt(0) !== char ? char + value : value;\n      } else {\n        url[part] = value;\n      }\n      break;\n\n    default:\n      url[part] = value;\n  }\n\n  for (var i = 0; i < rules.length; i++) {\n    var ins = rules[i];\n\n    if (ins[4]) url[ins[1]] = url[ins[1]].toLowerCase();\n  }\n\n  url.origin = url.protocol && url.host && url.protocol !== 'file:'\n    ? url.protocol +'//'+ url.host\n    : 'null';\n\n  url.href = url.toString();\n\n  return url;\n}\n\n/**\n * Transform the properties back in to a valid and full URL string.\n *\n * @param {Function} stringify Optional query stringify function.\n * @returns {String} Compiled version of the URL.\n * @public\n */\nfunction toString(stringify) {\n  if (!stringify || 'function' !== typeof stringify) stringify = qs.stringify;\n\n  var query\n    , url = this\n    , protocol = url.protocol;\n\n  if (protocol && protocol.charAt(protocol.length - 1) !== ':') protocol += ':';\n\n  var result = protocol + (url.slashes ? '//' : '');\n\n  if (url.username) {\n    result += url.username;\n    if (url.password) result += ':'+ url.password;\n    result += '@';\n  }\n\n  result += url.host + url.pathname;\n\n  query = 'object' === typeof url.query ? stringify(url.query) : url.query;\n  if (query) result += '?' !== query.charAt(0) ? '?'+ query : query;\n\n  if (url.hash) result += url.hash;\n\n  return result;\n}\n\nUrl.prototype = { set: set, toString: toString };\n\n//\n// Expose the URL parser and some additional properties that might be useful for\n// others or testing.\n//\nUrl.extractProtocol = extractProtocol;\nUrl.location = lolcation;\nUrl.qs = qs;\n\nmodule.exports = Url;\n"]}